(function(g){var k=function(f){return"http://query.yahooapis.com/v1/public/yql?q=__QUERY__&env=store://datatables.org/alltableswithkeys&format=json".replace("__QUERY__",encodeURIComponent(f))};g.fn.lifestream=function(f){var i=this,b=jQuery.extend({classname:"lifestream",limit:10},f),d={count:b.list.length,items:[]},a=jQuery.extend(true,{},b),e=function(c){g.merge(d.items,c);d.items.sort(function(m,n){return n.date-m.date});c=d.items;for(var h=c.length<b.limit?c.length:b.limit,j=0,l,o=g('<ul class="'+
b.classname+'"/>');j<h;j++){l=c[j];l.html&&g('<li class="'+b.classname+"-"+l.config.service+'">').append(l.html).appendTo(o)}i.html(o)};f=function(){var c=0,h=b.list.length;for(delete a.list;c<h;c++){var j=b.list[c];if(g.fn.lifestream.feeds[j.service]&&g.isFunction(g.fn.lifestream.feeds[j.service])&&j.user){j._settings=a;g.fn.lifestream.feeds[j.service](j,e)}}};jQuery.tmpl?f():jQuery.getScript("https://raw.github.com/jquery/jquery-tmpl/master/jquery.tmpl.min.js",f)};g.fn.lifestream.feeds=g.fn.lifestream.feeds||
{};g.fn.lifestream.feeds.blogger=function(f,i){g.ajax({url:k('select * from xml where url="http://'+f.user+'.blogspot.com/feeds/posts/default"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0&&b.query.results.feed.entry){b=b.query.results.feed.entry;for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.published),config:f,html:'posted "<a href="'+c.origLink+'">'+c.title+'</a>"'})}}i(d)}})};g.fn.lifestream.feeds.dailymotion=function(f,i){g.ajax({url:k('select * from xml where url="http://www.dailymotion.com/rss/user/'+
f.user+'"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0&&b.query.results.rss.channel.item){b=b.query.results.rss.channel.item;for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.pubDate),config:f,html:'uploaded a video <a href="'+c.link+'">'+c.title+"</a>"})}}i(d)}})};g.fn.lifestream.feeds.delicious=function f(i,b){i.template=g.extend({},f.template,i.template);g.ajax({url:"http://feeds.delicious.com/v2/json/"+i.user,dataType:"jsonp",success:function(d){var a=
[],e=0,c;if(d&&d.length&&d.length>0)for(c=d.length;e<c;e++){var h=d[e];a.push({date:new Date(h.dt),config:i,html:g.tmpl(i.template.bookmarkcreation,{url:h.u,title:h.d})})}b(a)}})};g.fn.lifestream.feeds.delicious.template={bookmarkcreation:'bookmarked <a href="${url}">${title}</a>'};g.fn.lifestream.feeds.deviantart=function f(i,b){i.template=g.extend({},f.template,i.template);g.ajax({url:k('select title,link,pubDate from rss where url="http://backend.deviantart.com/rss.xml?q=gallery%3A'+encodeURIComponent(i.user)+
'&type=deviation" | unique(field="title")'),dataType:"jsonp",success:function(d){var a=[],e,c=0,h;if(d.query&&d.query.count>0){d=d.query.results.item;for(h=d.length;c<h;c++){e=d[c];a.push({date:new Date(e.pubDate),config:i,html:g.tmpl(i.template.deviationpost,{url:e.link,title:e.title})})}}b(a)}})};g.fn.lifestream.feeds.deviantart.template={deviationpost:'posted <a href="${url}">${title}</a>'};g.fn.lifestream.feeds.dribbble=function(f,i){g.ajax({url:"http://api.dribbble.com/players/"+f.user+"/shots",
dataType:"jsonp",success:function(b){var d=[],a=0,e;if(b&&b.total)for(e=b.shots.length;a<e;a++){var c=b.shots[a];d.push({date:new Date(c.created_at),config:f,html:'posted a shot <a href="'+c.url+'">'+c.title+"</a>"})}i(d)}})};g.fn.lifestream.feeds.flickr=function(f,i){g.ajax({url:"http://api.flickr.com/services/feeds/photos_public.gne?id="+f.user+"&lang=en-us&format=json",dataType:"jsonp",jsonp:"jsoncallback",success:function(b){var d=[],a=0,e;if(b&&b.items&&b.items.length>0)for(e=b.items.length;a<
e;a++){var c=b.items[a];d.push({date:new Date(c.published),config:f,html:'posted a photo <a href="'+c.link+'">'+c.title+"</a>"})}i(d)}})};g.fn.lifestream.feeds.formspring=function(f,i){g.ajax({url:k('select * from xml where url="http://www.formspring.me/profile/'+f.user+'.rss"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0&&b.query.results.rss.channel.item){b=b.query.results.rss.channel.item;for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.pubDate),
config:f,html:'answered a question <a href="'+c.link+'">'+c.title+"</a>"})}}i(d)}})};g.fn.lifestream.feeds.forrst=function(f,i){g.ajax({url:"http://forrst.com/api/v2/users/posts?username="+f.user,dataType:"jsonp",success:function(b){var d=[],a=0,e;if(b&&b.resp.length&&b.resp.length>0)for(e=b.resp.length;a<e;a++){var c=b.resp[a];d.push({date:new Date(c.created_at),config:f,html:"Posted a "+c.post_type+' titled <a href="'+c.post_url+'">'+c.title+"</a>"})}i(d)}})};g.fn.lifestream.feeds.foursquare=function(f,
i){g.ajax({url:k('select * from rss where url="https://feeds.foursquare.com/history/'+f.user+'.rss"'),dataType:"jsonp",success:function(b){var d=[],a=0,e;if(b.query&&b.query.count&&b.query.count>0)for(e=b.query.count;a<e;a++){var c=b.query.results.item[a];d.push({date:new Date(c.pubDate),config:f,html:'checked in @ <a href="'+c.link+'">'+c.title+"</a>"})}i(d)}})};g.fn.lifestream.feeds.github=function(f,i){var b=function(a){return a.payload.repo||a.repository.owner+"/"+a.repository.name},d=function(a){var e=
"",c,h,j;if(a.type==="PushEvent"){c="";h=b(a);if(a.payload&&a.payload.shas&&a.payload.shas.json&&a.payload.shas.json[2])c=a.payload.shas.json[2]+" by "+a.payload.shas.json[3];e+='<a href="'+a.url+'" title="'+c+'">pushed</a> to <a href="http://github.com/'+h+'">'+h+"</a>"}else if(a.type==="GistEvent"){c=a.payload.desc||"";e+=a.payload.action+'d <a href="'+a.payload.url+'" title ="'+c+'">'+a.payload.name+"</a>"}else if(a.type==="CommitCommentEvent"||a.type==="IssueCommentEvent"){h=b(a);e+='<a href="'+
a.url+'">commented</a> on <a href="http://github.com/'+h+'">'+h+"</a>"}else if(a.type==="PullRequestEvent"){h=a.payload.repo||a.repository.owner+"/"+a.repository.name;e+='<a href="'+a.url+'">'+a.payload.action+'</a> pull request on <a href="http://github.com/'+h+'">'+h+"</a>"}else if(a.type==="CreateEvent"&&(a.payload.ref_type==="tag"||a.payload.ref_type==="branch"||a.payload.object==="tag")){h=b(a);j=a.payload.ref_type||a.payload.object;c=a.payload.ref||a.payload.object_name;e+="created "+j+' <a href="'+
a.url+'">'+c+'</a> for <a href="http://github.com/'+h+'">'+h+"</a>"}else if(a.type==="CreateEvent"){c=a.payload.object_name==="null"?a.payload.name:a.payload.object_name;e+="created "+a.payload.object+' <a href="'+a.url+'">'+c+"</a>"}else if(a.type==="DeleteEvent")e+="deleted "+a.payload.ref_type+' <a href="http://github.com/'+a.repository.owner+"/"+a.repository.name+'">'+a.payload.ref+"</a>";return e};g.ajax({url:k('select json.repository.owner,json.repository.name,json.payload,json.type,json.url, json.created_at from json where url="http://github.com/'+
f.user+'.json"'),dataType:"jsonp",success:function(a){var e=[],c=0,h;if(a.query&&a.query.count&&a.query.count>0)for(h=a.query.count;c<h;c++){var j=a.query.results.json[c].json;e.push({date:new Date(j.created_at),config:f,html:d(j)})}i(e)}})};g.fn.lifestream.feeds.googlereader=function(f,i){g.ajax({url:k('select * from xml where url="www.google.com/reader/public/atom/user%2F'+f.user+'%2Fstate%2Fcom.google%2Fstarred"'),dataType:"jsonp",success:function(b){var d=[],a=0,e;if(b.query&&b.query.count&&b.query.count>
0){b=b.query.results.feed.entry;for(e=b.length;a<e;a++){var c=b[a];d.push({date:new Date(parseInt(c["crawl-timestamp-msec"],10)),config:f,html:'starred post <a href="'+c.link.href+'">'+c.title.content+"</a>"})}}i(d)}})};g.fn.lifestream.feeds.iusethis=function(f,i){g.ajax({url:k('select * from xml where url="http://iphone.iusethis.com/user/feed.rss/'+f.user+'" or url="http://osx.iusethis.com/user/feed.rss/'+f.user+'" or url="http://win.iusethis.com/user/feed.rss/'+f.user+'"'),dataType:"jsonp",success:function(b){var d=
[],a,e,c,h,j,l=0,o,m,n,p,q,r,s=["iPhone","OS X","Windows"];if(b.query&&b.query.count&&b.query.count>0&&b.query.results.rss){o=b.query.results.rss.length;p=["started using","stopped using","stopped loving","Downloaded","commented on","updated entry for","started loving","registered"];for(j=p.length;l<o;l++){r=s[l];a=b.query.results.rss[l].channel.item;e=0;for(c=a.length;e<c;e++){m=a[e];n=m.title.replace(f.user+" ","");for(h=0;h<j;h++)if(n.indexOf(p[h])>-1){q=p[h];break}h=n.split(q);d.push({date:new Date(m.pubDate),
config:f,html:q.toLowerCase()+' <a href="'+m.link+'">'+h[1]+"</a> ("+r+")"})}}}i(d)}})};g.fn.lifestream.feeds.lastfm=function(f,i){var b=function(d){var a="";a+='loved <a href="'+d.url+'">'+d.name+'</a> by <a href="'+d.artist.url+'">'+d.artist.name+"</a>";return a};g.ajax({url:k('select * from xml where url="http://ws.audioscrobbler.com/2.0/user/'+f.user+'/lovedtracks.xml"'),dataType:"jsonp",success:function(d){var a=[],e=0,c;if(d.query&&d.query.count&&d.query.count>0&&d.query.results.lovedtracks&&
d.query.results.lovedtracks.track){d=d.query.results.lovedtracks.track;for(c=d.length;e<c;e++){var h=d[e];a.push({date:new Date(parseInt(h.date.uts*1E3,10)),config:f,html:b(h)})}}i(a)}})};g.fn.lifestream.feeds.picplz=function(f,i){g.ajax({url:"http://picplz.com/api/v2/user.json?username="+f.user+"&include_pics=1",dataType:"jsonp",success:function(b){var d=[],a=0,e;if((e=b.value.users[0].pics)&&e.length&&e.length>0)for(b=e.length;a<b;a++){var c=e[a];d.push({date:new Date(c.date*1E3),config:f,html:'Uploaded <a href="'+
c.pic_files["640r"].img_url+'">'+(c.caption||c.id)+"</a>"})}i(d)}})};g.fn.lifestream.feeds.pinboard=function(f,i){g.ajax({url:k('select * from xml where url="http://feeds.pinboard.in/rss/u:'+f.user+'"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0){b=b.query.results.RDF.item;for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.date),config:f,html:'added bookmark <a href="'+c.link+'">'+c.title+"</a>"})}}i(d)}})};g.fn.lifestream.feeds.posterous=
function(f,i){g.ajax({url:k('select * from xml where url="http://'+f.user+'.posterous.com/rss.xml"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0&&b.query.results.rss.channel.item){b=b.query.results.rss.channel.item;for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.pubDate),config:f,html:'posted "<a href="'+c.link+'">'+c.title+'</a>"'})}}i(d)}})};g.fn.lifestream.feeds.reddit=function(f,i){var b=function(d){var a="",e="",c="http://www.reddit.com/r/"+
d.data.subreddit,h=d.data.ups-d.data.downs;h=h>0?"+"+h:h;if(d.kind==="t1"){e="http://www.reddit.com/r/"+d.data.subreddit+"/comments/"+d.data.link_id.substring(3)+"/u/"+d.data.name.substring(3)+"?context=3";a+='<a href="'+e+'">commented ('+h+")</a> "}else if(d.kind==="t3")a+='<a href="http://www.reddit.com'+d.data.permalink+'">created new thread ('+h+")</a> ";a+=' in <a href="'+c+'">/r/'+d.data.subreddit+"</a>";return a};g.ajax({url:"http://www.reddit.com/user/"+f.user+".json",dataType:"jsonp",jsonp:"jsonp",
success:function(d){var a=[],e=0,c;if(d&&d.data&&d.data.children&&d.data.children.length>0)for(c=d.data.children.length;e<c;e++){var h=d.data.children[e];a.push({date:new Date(h.data.created*1E3),config:f,html:b(h)})}i(a)}})};g.fn.lifestream.feeds.slideshare=function(f,i){g.ajax({url:k('select * from xml where url="http://www.slideshare.net/rss/user/'+f.user+'"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0){b=b.query.results.rss.channel.item;for(e=
b.length;a<e;a++){c=b[a];d.push({date:new Date(c.pubDate),config:f,html:'uploaded a presentation <a href="'+c.link+'">'+c.title+"</a>"})}}i(d)}})};g.fn.lifestream.feeds.stackoverflow=function(f,i){var b=function(d){var a="",e="",c="",h="",j="http://stackoverflow.com/users/"+f.user;if(d.timeline_type==="badge"){e=d.timeline_type+" "+d.action+": "+d.description;c=d.detail;h=j+"?tab=reputation"}else if(d.timeline_type==="revision"||d.timeline_type==="comment"||d.timeline_type==="accepted"||d.timeline_type===
"askoranswered"){e=d.post_type+" "+d.action;c=d.detail||d.description||"";h="http://stackoverflow.com/questions/"+d.post_id}a+='<a href="'+h+'" title="'+c+'">'+e+"</a> - "+c;return a};g.ajax({url:"http://api.stackoverflow.com/1.1/users/"+f.user+"/timeline?jsonp",dataType:"jsonp",jsonp:"jsonp",success:function(d){var a=[],e=0,c;if(d&&d.total&&d.total>0&&d.user_timelines)for(c=d.user_timelines.length;e<c;e++){var h=d.user_timelines[e];a.push({date:new Date(h.creation_date*1E3),config:f,html:b(h)})}i(a)}})};
g.fn.lifestream.feeds.tumblr=function(f,i){var b=function(d,a){return{date:new Date(a.date),config:d,html:"posted a "+a.type+' <a href="'+a.url+'">'+(a["regular-title"]||a["quote-text"]||a["conversation-title"]||a["photo-caption"]||a["video-caption"]||a["audio-caption"]||a["regular-body"]||a["link-text"]||a.type||"").replace(/<.+?>/gi," ")+"</a>"}};g.ajax({url:k('select * from tumblr.posts where username="'+f.user+'"'),dataType:"jsonp",success:function(d){var a=[],e=0,c,h;if(d.query&&d.query.count&&
d.query.count>0)if(g.isArray(d.query.results.posts.post))for(c=d.query.results.posts.post.length;e<c;e++){h=d.query.results.posts.post[e];a.push(b(f,h))}else g.isPlainObject(d.query.results.posts.post)&&a.push(b(f,d.query.results.posts.post));i(a)}})};g.fn.lifestream.feeds.twitter=function(f,i){var b=function(a){return function(e){return e.replace(/(^|[^\w'"]+)\#([a-zA-Z0-9_]+)/g,function(c,h,j){return h+'<a href="http://search.twitter.com/search?q=%23'+j+'">#'+j+"</a>"})}(function(e){return e.replace(/(^|[^\w]+)\@([a-zA-Z0-9_]{1,15})/g,
function(c,h,j){return h+'<a href="http://twitter.com/'+j+'">@'+j+"</a>"})}(function(e){return e.replace(/[a-z]+:\/\/[a-z0-9-_]+\.[a-z0-9-_:~%&\?\/.=]+[^:\.,\)\s*$]/ig,function(c){return'<a href="'+c+'">'+(c.length>25?c.substr(0,24)+"...":c)+"</a>"})}(a)))},d=function(a){return b(a).replace(/ #([A-Za-z0-9\/\.]*)/g,function(e){return' <a target="_new" href="http://twitter.com/search?q='+e.replace(" #","%23")+'">'+e+"</a>"}).replace(/@[\w]+/g,function(e){return'<a href="http://www.twitter.com/'+e.replace("@",
"")+'">'+e+"</a>"})};g.ajax({url:k('select status.id, status.created_at, status.text from twitter.user.timeline where screen_name="'+f.user+'"'),dataType:"jsonp",success:function(a){var e=[],c=0,h;if(a.query&&a.query.count&&a.query.count>0)for(h=a.query.count;c<h;c++){var j=a.query.results.statuses[c].status;e.push({date:new Date(j.created_at),config:f,html:d(j.text)})}i(e)}})};g.fn.lifestream.feeds.vimeo=function(f,i){g.ajax({url:"http://vimeo.com/api/v2/"+f.user+"/videos.json",dataType:"jsonp",
crossDomain:true,success:function(b){var d=[],a=0,e,c;if(b)for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.upload_date),config:f,html:'published a video <a href="'+c.url+'" title="'+c.description.replace(/"/g,"'").replace(/<.+?>/gi,"")+'">'+c.title+"</a>"})}i(d)}})};g.fn.lifestream.feeds.wordpress=function(f,i){g.ajax({url:k('select * from xml where url="http://'+f.user+'.wordpress.com/feed"'),dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.query&&b.query.count&&b.query.count>0&&
b.query.results.rss.channel.item){b=b.query.results.rss.channel.item;for(e=b.length;a<e;a++){c=b[a];d.push({date:new Date(c.pubDate),config:f,html:'posted "<a href="'+c.link+'">'+c.title+'</a>"'})}}i(d)}})};g.fn.lifestream.feeds.youtube=function(f,i){g.ajax({url:"http://gdata.youtube.com/feeds/api/users/"+f.user+"/favorites?v=2&alt=jsonc",dataType:"jsonp",success:function(b){var d=[],a=0,e,c;if(b.data&&b.data.items)for(e=b.data.items.length;a<e;a++){c=b.data.items[a];d.push({date:new Date(c.created),
config:f,html:' favorited <a href="'+c.video.player["default"]+'" title="'+c.video.description+'">'+c.video.title+"</a>"})}i(d)}})}})(jQuery);
