(function(h){var m=function(f){return"http://query.yahooapis.com/v1/public/yql?q=__QUERY__&env=store://datatables.org/alltableswithkeys&format=json".replace("__QUERY__",encodeURIComponent(f))};h.fn.lifestream=function(f){var i=this,d=jQuery.extend({classname:"lifestream",limit:10},f),c={count:d.list.length,items:[]},a=jQuery.extend(true,{},d),e=function(b){h.merge(c.items,b);c.items.sort(function(l,n){return l.date>n.date?-1:l.date===n.date?0:1});b=c.items;for(var g=b.length<d.limit?b.length:d.limit,
j=0,k,o=h('<ul class="'+d.classname+'"/>');j<g;++j){k=b[j];k.html&&h('<li class="'+d.classname+"-"+k.config.service+'">').append(k.html).appendTo(o)}i.html(o)};f=function(){var b=0,g=d.list.length;for(delete a.list;b<g;b++){var j=d.list[b];if(h.fn.lifestream.feeds[j.service]&&h.isFunction(h.fn.lifestream.feeds[j.service])&&j.user){j._settings=a;h.fn.lifestream.feeds[j.service](j,e)}}};jQuery.tmpl?f():jQuery.getScript("https://raw.github.com/jquery/jquery-tmpl/master/jquery.tmpl.min.js",f)};h.fn.lifestream.linkify=
function(){var f=RegExp("(?:\\b[a-z\\d.-]+://[^<>\\s]+|\\b(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5]))(?:[;/][^#?<>\\s]*)?(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w)|(?:mailto:)?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw)|(?:(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5])\\.){3}(?:[0-9]|[1-9]\\d|1\\d{2}|2[0-4]\\d|25[0-5]))(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w))",
"ig"),i=/^[a-z\d.-]+:\/\//i,d={"'":"`",">":"<",")":"(","]":"[","}":"{","\u00bb":"\u00ab","\u203a":"\u2039"},c={callback:function(a,e){return e?'<a href="'+e+'" title="'+e+'">'+a+"</a>":a},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(a,e){e=e||{};var b,g,j="",k=[],o,l,n,p,q;for(b in c)if(c.hasOwnProperty(b)&&e[b]===undefined)e[b]=c[b];for(;b=f.exec(a);){b=b[0];l=f.lastIndex;n=l-b.length;if(!/[\/:]/.test(a.charAt(n-1))){do{g=b;q=b.substr(-1);
if(p=d[q]){p=b.match(RegExp("\\"+p+"(?!$)","g"));q=b.match(RegExp("\\"+q,"g"));if((p?p.length:0)<(q?q.length:0)){b=b.substr(0,b.length-1);l--}}if(e.punct_regexp)b=b.replace(e.punct_regexp,function(r){l-=r.length;return""})}while(b.length&&b!==g);g=b;i.test(g)||(g=(g.indexOf("@")!==-1?!g.indexOf("mailto:")?"":"mailto:":!g.indexOf("irc.")?"irc://":!g.indexOf("ftp.")?"ftp://":"http://")+g);if(o!=n){k.push([a.slice(o,n)]);o=l}k.push([b,g])}}k.push([a.substr(o)]);for(b=0;b<k.length;b++)j+=e.callback.apply(window,
k[b]);return j||a}}();h.fn.lifestream.feeds=h.fn.lifestream.feeds||{};h.fn.lifestream.feeds.dailymotion=function(f,i){h.ajax({url:m('select * from xml where url="http://www.dailymotion.com/rss/user/'+f.user+'"'),dataType:"jsonp",success:function(d){var c=[],a=0,e,b;if(d.query&&d.query.count&&d.query.count>0&&d.query.results.rss.channel.item){d=d.query.results.rss.channel.item;for(e=d.length;a<e;a++){b=d[a];c.push({date:new Date(b.pubDate),config:f,html:'uploaded a video <a href="'+b.link+'">'+b.title+
"</a>"})}}i(c)}})};h.fn.lifestream.feeds.delicious=function f(i,d){i.template=h.extend({},f.template,i.template);h.ajax({url:"http://feeds.delicious.com/v2/json/"+i.user,dataType:"jsonp",success:function(c){var a=[],e=0,b;if(c&&c.length&&c.length>0)for(b=c.length;e<b;e++){var g=c[e];a.push({date:new Date(g.dt),config:i,html:h.tmpl(i.template.bookmarkcreation,{url:g.u,title:g.d})})}d(a)}})};h.fn.lifestream.feeds.delicious.template={bookmarkcreation:'bookmarked <a href="${url}">${title}</a>'};h.fn.lifestream.feeds.deviantart=
function f(i,d){i.template=h.extend({},f.template,i.template);h.ajax({url:m('select title,link,pubDate from rss where url="http://backend.deviantart.com/rss.xml?q=gallery%3A'+encodeURIComponent(i.user)+'&type=deviation" | unique(field="title")'),dataType:"jsonp",success:function(c){var a=[],e,b=0,g;if(c.query&&c.query.count>0){c=c.query.results.item;for(g=c.length;b<g;++b){e=c[b];a.push({date:new Date(e.pubDate),config:i,html:h.tmpl(i.template.deviationpost,{url:e.link,title:e.title})})}}d(a)}})};
h.fn.lifestream.feeds.deviantart.template={deviationpost:'posted <a href="${url}">${title}</a>'};h.fn.lifestream.feeds.dribbble=function(f,i){h.ajax({url:"http://api.dribbble.com/players/"+f.user+"/shots",dataType:"jsonp",success:function(d){var c=[],a=0,e;if(d&&d.total)for(e=d.shots.length;a<e;a++){var b=d.shots[a];c.push({date:new Date(b.created_at),config:f,html:'posted a shot <a href="'+b.url+'">'+b.title+"</a>"})}i(c)}})};h.fn.lifestream.feeds.flickr=function(f,i){h.ajax({url:"http://api.flickr.com/services/feeds/photos_public.gne?id="+
f.user+"&lang=en-us&format=json",dataType:"jsonp",jsonp:"jsoncallback",success:function(d){var c=[],a=0,e;if(d&&d.items&&d.items.length>0)for(e=d.items.length;a<e;a++){var b=d.items[a];c.push({date:new Date(b.published),config:f,html:'posted a photo <a href="'+b.link+'">'+b.title+"</a>"})}i(c)}})};h.fn.lifestream.feeds.forrst=function(f,i){h.ajax({url:"http://forrst.com/api/v2/users/posts?username="+f.user+"",dataType:"jsonp",success:function(d){var c=[],a=0,e;if(d&&d.resp.length&&d.resp.length>0)for(e=
d.resp.length;a<e;a++){var b=d.resp[a];c.push({date:new Date(b.created_at),config:f,html:"Posted a "+b.post_type+' titled <a href="'+b.post_url+'">'+b.title+"</a>"})}i(c)}})};h.fn.lifestream.feeds.foursquare=function(f,i){h.ajax({url:m('select * from rss where url="https://feeds.foursquare.com/history/'+f.user+'.rss"'),dataType:"jsonp",success:function(d){var c=[],a=0,e;if(d.query&&d.query.count&&d.query.count>0)for(e=d.query.count;a<e;a++){var b=d.query.results.item[a];c.push({date:new Date(b.pubDate),
config:f,html:'checked in @ <a href="'+b.link+'">'+b.title+"</a>"})}i(c)}})};h.fn.lifestream.feeds.github=function(f,i){var d=function(a){return a.payload.repo||a.repository.owner+"/"+a.repository.name},c=function(a){var e="",b,g,j;if(a.type==="PushEvent"){b="";g=d(a);if(a.payload&&a.payload.shas&&a.payload.shas.json&&a.payload.shas.json[2])b=a.payload.shas.json[2]+" by "+a.payload.shas.json[3];e+='<a href="'+a.url+'" title="'+b+'">pushed</a> to <a href="http://github.com/'+g+'">'+g+"</a>"}else if(a.type===
"GistEvent"){b=a.payload.desc||"";e+=a.payload.action+'d <a href="'+a.payload.url+'" title ="'+b+'">'+a.payload.name+"</a>"}else if(a.type==="CommitCommentEvent"||a.type==="IssueCommentEvent"){g=d(a);e+='<a href="'+a.url+'">commented</a> on <a href="http://github.com/'+g+'">'+g+"</a>"}else if(a.type==="PullRequestEvent"){g=a.payload.repo||a.repository.owner+"/"+a.repository.name;e+='<a href="'+a.url+'">'+a.payload.action+'</a> pull request on <a href="http://github.com/'+g+'">'+g+"</a>"}else if(a.type===
"CreateEvent"&&(a.payload.ref_type==="tag"||a.payload.ref_type==="branch"||a.payload.object==="tag")){g=d(a);j=a.payload.ref_type||a.payload.object;b=a.payload.ref||a.payload.object_name;e+="created "+j+' <a href="'+a.url+'">'+b+'</a> for <a href="http://github.com/'+g+'">'+g+"</a>"}else if(a.type==="CreateEvent"){b=a.payload.object_name==="null"?a.payload.name:a.payload.object_name;e+="created "+a.payload.object+' <a href="'+a.url+'">'+b+"</a>"}else if(a.type==="DeleteEvent")e+="deleted "+a.payload.ref_type+
' <a href="http://github.com/'+a.repository.owner+"/"+a.repository.name+'">'+a.payload.ref+"</a>";return e};h.ajax({url:m('select json.repository.owner,json.repository.name,json.payload,json.type,json.url, json.created_at from json where url="http://github.com/'+f.user+'.json"'),dataType:"jsonp",success:function(a){var e=[],b=0,g;if(a.query&&a.query.count&&a.query.count>0)for(g=a.query.count;b<g;b++){var j=a.query.results.json[b].json;e.push({date:new Date(j.created_at),config:f,html:c(j)})}i(e)}})};
h.fn.lifestream.feeds.googlereader=function(f,i){h.ajax({url:m('select * from xml where url="www.google.com/reader/public/atom/user%2F'+f.user+'%2Fstate%2Fcom.google%2Fstarred"'),dataType:"jsonp",success:function(d){var c=[],a=0,e;if(d.query&&d.query.count&&d.query.count>0){d=d.query.results.feed.entry;for(e=d.length;a<e;a++){var b=d[a];c.push({date:new Date(parseInt(b["crawl-timestamp-msec"],10)),config:f,html:'starred post <a href="'+b.link.href+'">'+b.title.content+"</a>"})}}i(c)}})};h.fn.lifestream.feeds.iusethis=
function(f,i){h.ajax({url:m('select * from xml where url="http://iphone.iusethis.com/user/feed.rss/'+f.user+'" or url="http://osx.iusethis.com/user/feed.rss/'+f.user+'" or url="http://win.iusethis.com/user/feed.rss/'+f.user+'"'),dataType:"jsonp",success:function(d){var c=[],a,e,b,g,j,k=0,o,l,n,p,q,r,s=["iPhone","OS X","Windows"];if(d.query&&d.query.count&&d.query.count>0&&d.query.results.rss){o=d.query.results.rss.length;p=["started using","stopped using","stopped loving","Downloaded","commented on",
"updated entry for","started loving","registered"];for(j=p.length;k<o;k++){r=s[k];a=d.query.results.rss[k].channel.item;e=0;for(b=a.length;e<b;e++){l=a[e];n=l.title.replace(f.user+" ","");for(g=0;g<j;g++)if(n.indexOf(p[g])>-1){q=p[g];break}g=n.split(q);c.push({date:new Date(l.pubDate),config:f,html:q.toLowerCase()+' <a href="'+l.link+'">'+g[1]+"</a> ("+r+")"})}}}i(c)}})};h.fn.lifestream.feeds.lastfm=function(f,i){var d=function(c){var a="";a+='loved <a href="'+c.url+'">'+c.name+'</a> by <a href="'+
c.artist.url+'">'+c.artist.name+"</a>";return a};h.ajax({url:m('select * from xml where url="http://ws.audioscrobbler.com/2.0/user/'+f.user+'/lovedtracks.xml"'),dataType:"jsonp",success:function(c){var a=[],e=0,b;if(c.query&&c.query.count&&c.query.count>0&&c.query.results.lovedtracks&&c.query.results.lovedtracks.track){c=c.query.results.lovedtracks.track;for(b=c.length;e<b;e++){var g=c[e];a.push({date:new Date(parseInt(g.date.uts*1E3,10)),config:f,html:d(g)})}}i(a)}})};h.fn.lifestream.feeds.picplz=
function(f,i){h.ajax({url:"http://picplz.com/api/v2/user.json?username="+f.user+"&include_pics=1",dataType:"jsonp",success:function(d){var c=[],a=0,e;if((e=d.value.users[0].pics)&&e.length&&e.length>0)for(d=e.length;a<d;a++){var b=e[a];c.push({date:new Date(b.date*1E3),config:f,html:'Uploaded <a href="'+b.pic_files["640r"].img_url+'">'+(b.caption||b.id)+"</a>"})}i(c)}})};h.fn.lifestream.feeds.pinboard=function(f,i){h.ajax({url:m('select * from xml where url="http://feeds.pinboard.in/rss/u:'+f.user+
'"'),dataType:"jsonp",success:function(d){var c=[],a=0,e,b;if(d.query&&d.query.count&&d.query.count>0){d=d.query.results.RDF.item;for(e=d.length;a<e;a++){b=d[a];c.push({date:new Date(b.date),config:f,html:'added bookmark <a href="'+b.link+'">'+b.title+"</a>"})}}i(c)}})};h.fn.lifestream.feeds.reddit=function(f,i){var d=function(c){var a="",e="",b="http://www.reddit.com/r/"+c.data.subreddit,g=c.data.ups-c.data.downs;g=g>0?"+"+g:g;if(c.kind==="t1"){e="http://www.reddit.com/r/"+c.data.subreddit+"/comments/"+
c.data.link_id.substring(3)+"/u/"+c.data.name.substring(3)+"?context=3";a+='<a href="'+e+'">commented ('+g+")</a> "}else if(c.kind==="t3")a+='<a href="http://www.reddit.com'+c.data.permalink+'">created new thread ('+g+")</a> ";a+=' in <a href="'+b+'">/r/'+c.data.subreddit+"</a>";return a};h.ajax({url:"http://www.reddit.com/user/"+f.user+".json",dataType:"jsonp",jsonp:"jsonp",success:function(c){var a=[],e=0,b;if(c&&c.data&&c.data.children&&c.data.children.length>0)for(b=c.data.children.length;e<b;e++){var g=
c.data.children[e];a.push({date:new Date(g.data.created*1E3),config:f,html:d(g)})}i(a)}})};h.fn.lifestream.feeds.slideshare=function(f,i){h.ajax({url:m('select * from xml where url="http://www.slideshare.net/rss/user/'+f.user+'"'),dataType:"jsonp",success:function(d){var c=[],a=0,e,b;if(d.query&&d.query.count&&d.query.count>0){d=d.query.results.rss.channel.item;for(e=d.length;a<e;a++){b=d[a];c.push({date:new Date(b.pubDate),config:f,html:'uploaded a presentation <a href="'+b.link+'">'+b.title+"</a>"})}}i(c)}})};
h.fn.lifestream.feeds.stackoverflow=function(f,i){var d=function(c){var a="",e="",b="",g="",j="http://stackoverflow.com/users/"+f.user;if(c.timeline_type==="badge"){e=c.timeline_type+" "+c.action+": "+c.description;b=c.detail;g=j+"?tab=reputation"}else if(c.timeline_type==="revision"||c.timeline_type==="comment"||c.timeline_type==="accepted"||c.timeline_type==="askoranswered"){e=c.post_type+" "+c.action;b=c.detail||c.description||"";g="http://stackoverflow.com/questions/"+c.post_id}a+='<a href="'+
g+'" title="'+b+'">'+e+"</a> - "+b;return a};h.ajax({url:"http://api.stackoverflow.com/1.1/users/"+f.user+"/timeline?jsonp",dataType:"jsonp",jsonp:"jsonp",success:function(c){var a=[],e=0,b;if(c&&c.total&&c.total>0&&c.user_timelines)for(b=c.user_timelines.length;e<b;e++){var g=c.user_timelines[e];a.push({date:new Date(g.creation_date*1E3),config:f,html:d(g)})}i(a)}})};h.fn.lifestream.feeds.tumblr=function(f,i){var d=function(c,a){return{date:new Date(a.date),config:c,html:"posted a "+a.type+' <a href="'+
a.url+'">'+(a["regular-title"]||a["quote-text"]||a["conversation-title"]||a["photo-caption"]||a["video-caption"]||a["audio-caption"]||a["regular-body"]||a["link-text"]||a.type||"").replace(/\<.+?\>/gi," ")+"</a>"}};h.ajax({url:m('select * from tumblr.posts where username="'+f.user+'"'),dataType:"jsonp",success:function(c){var a=[],e=0,b,g;if(c.query&&c.query.count&&c.query.count>0)if(h.isArray(c.query.results.posts.post))for(b=c.query.results.posts.post.length;e<b;e++){g=c.query.results.posts.post[e];
a.push(d(f,g))}else h.isPlainObject(c.query.results.posts.post)&&a.push(d(f,c.query.results.posts.post));i(a)}})};h.fn.lifestream.feeds.twitter=function(f,i){var d=function(c){return h.fn.lifestream.linkify(c).replace(/ #([A-Za-z0-9\/\.]*)/g,function(a){return' <a target="_new" href="http://twitter.com/search?q='+a.replace(" #","%23")+'">'+a+"</a>"}).replace(/@[\w]+/g,function(a){return'<a href="http://www.twitter.com/'+a.replace("@","")+'">'+a+"</a>"})};h.ajax({url:m('select status.id, status.created_at, status.text from twitter.user.timeline where screen_name="'+
f.user+'"'),dataType:"jsonp",success:function(c){var a=[],e=0,b;if(c.query&&c.query.count&&c.query.count>0)for(b=c.query.count;e<b;e++){var g=c.query.results.statuses[e].status;a.push({date:new Date(g.created_at),config:f,html:d(g.text)})}i(a)}})};h.fn.lifestream.feeds.vimeo=function(f,i){h.ajax({url:"http://vimeo.com/api/v2/"+f.user+"/videos.json",dataType:"jsonp",crossDomain:true,success:function(d){var c=[],a=0,e,b;if(d)for(e=d.length;a<e;a++){b=d[a];c.push({date:new Date(b.upload_date),config:f,
html:'published a video <a href="'+b.url+'" title="'+b.description.replace(/"/g,"'").replace(/\<.+?\>/gi,"")+'">'+b.title+"</a>"})}i(c)}})};h.fn.lifestream.feeds.youtube=function(f,i){h.ajax({url:"http://gdata.youtube.com/feeds/api/users/"+f.user+"/favorites?v=2&alt=jsonc",dataType:"jsonp",success:function(d){var c=[],a=0,e,b;if(d.data&&d.data.items)for(e=d.data.items.length;a<e;a++){b=d.data.items[a];c.push({date:new Date(b.created),config:f,html:' favorited <a href="'+b.video.player["default"]+
'" title="'+b.video.description+'">'+b.video.title+"</a>"})}i(c)}})}})(jQuery);
